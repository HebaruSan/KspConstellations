CONTRACT_TYPE
{
	sortKey = a
	name = ConstellationsKsoRelay1
	group = KerbinConstellations

	title = Place a relay satellite in kerbostationary orbit above the KSC
	description = Pesky Kerbin keeps obscuring our tracking station. We need a radio dish somewhere higher... much higher. Wernher von Kerman suggests putting a relay in kerbostationary orbit above the KSC. This way it'll be always in view of the tracking station.

	synopsis = Place a relay satellite in kerbostationary orbit above the KSC

	maxCompletions = 1
	maxSimultaneous = 1

	completedMessage = The relay is in position.

	prestige = Significant

	targetBody = Kerbin

	rewardScience = 0
	rewardReputation = 30
	rewardFunds = 150000.0
	advanceFunds = 100000.0
	failureReputation = 20
	failureFunds = 100000.0

	REQUIREMENT
	{
		name = Expression
		type = Expression
		title = The homeworld can have a stationary orbit
		expression = HomeWorld().CanHaveSynchronousOrbit(0)
	}

	REQUIREMENT
	{
		name = Any
		type = Any

		title = Have solar panels unlocked.

		REQUIREMENT
		{
			name = PartModuleUnlocked
			type = PartModuleUnlocked
			partModule = ModuleDeployableSolarPanel
		}
		REQUIREMENT:NEEDS[NearFutureSolar]
		{
			name = PartModuleUnlocked
			type = PartModuleUnlocked
			partModule = ModuleCurvedSolarPanel
		}
		REQUIREMENT:NEEDS[Kopernicus]
		{
			name = PartModuleUnlocked
			type = PartModuleUnlocked
			partModule = KopernicusSolarPanel
		}
	}

	REQUIREMENT
	{
		name = TechResearched
		type = TechResearched

		part = RelayAntenna100
	}

	BEHAVIOUR
	{
		name = SpawnVessel
		type = SpawnVessel

		VESSEL
		{
			name = KSO Relay Marker
			craftPart = constellations-dummy
			owned = False
			targetBody = Kerbin
			vesselType = DroppedPart

			ORBIT
			{
				SMA = 3463334.0398701429
				ECC = 0
				INC = 0
				LPE = 237.38459898406168
				LAN = 0
				MNA = 1.5322871042446775
				EPH = 18545.434569902998
				REF = 1
			}
		}
	}

	PARAMETER
	{
		name = VesselParameterGroup
		type = VesselParameterGroup

		define = KSO Relay
		dissassociateVesselsOnContractFailure = true

		PARAMETER
		{
			name = NewVessel
			type = NewVessel
		}

		PARAMETER
		{
			name = HasCrew
			type = HasCrew
			minCrew = 0
			maxCrew = 0
		}

		PARAMETER
		{
			name = HasAntenna
			type = HasAntenna
			minAntennaPower = 200000000000 // 200G
			antennaType = RELAY
			notes = This will probably require multiple antennas, remember that combining antennas is non-linear.\nAlso note that difficulty settings alters the antenna power, so there might be a mismatch between antenna ratings shown in VAB and the actual power.
		}

		PARAMETER
		{
			name = SolarPower
			type = Any
			title = Have solar panels onboard

			PARAMETER
			{
				name = PartValidationStockSolar
				type = PartValidation
				title = 1 or more solar panels
				hideChildren = true

				partModule = ModuleDeployableSolarPanel
				minCount = 1
			}
		
			PARAMETER:NEEDS[NearFutureSolar]
			{
				name = PartValidationNearFutureSolar
				type = PartValidation
				title = 1 or more curved solar panels
				hideChildren = true
				
				partModule = ModuleCurvedSolarPanel
				minCount = 1
			}
		
			PARAMETER:NEEDS[Kopernicus]
			{
				name = PartValidationKopernicusSolar
				type = PartValidation
				hideChildren = true
				title = 1 or more solar panels
				partModule = KopernicusSolarPanel
				minCount = 1
			}
		}

		PARAMETER
		{
			name = Orbit
			type = Orbit

			targetBody = Kerbin

			minPeriod = 5h 58m 59s
			maxPeriod = 5h 59m 19s

			minAltitude = 2860834
			maxAltitude = 2865834

			maxInclination = 0.1

			notes = An ideal kerbostationary orbit has a period of 5h 59m 9s and an altitude of 2863334 meters
		}

		PARAMETER
		{
			name = Rendezvous
			type = Rendezvous

			vessel = KSO Relay Marker
			distance = 10000

			title = Place the relay within 10km of the marker

			disableOnStateChange = true
		}

		duration = 2d
	}

	PARAMETER
	{
		name = VesselParameterGroup
		type = VesselParameterGroup

		vessel = KSO Relay

		title = Circularize at 2863334m with less than 100m deviation (Optional)

		optional = True
		rewardReputation = 10.0

		PARAMETER
		{
			name = Orbit
			type = Orbit

			minAltitude = 2863234
			maxAltitude = 2863434
		}
	}

	PARAMETER
	{
		name = VesselParameterGroup
		type = VesselParameterGroup

		vessel = KSO Relay

		title = Circularize at 2863334m with less than 1m deviation (Optional)

		optional = True
		rewardReputation = 20.0

		PARAMETER
		{
			name = Orbit
			type = Orbit

			minAltitude = 2863333.5
			maxAltitude = 2863334.49
		}
	}

	PARAMETER
	{
		name = VesselParameterGroup
		type = VesselParameterGroup

		vessel = KSO Relay

		title = Place the relay within 100m of the marker (Optional)

		optional = True
		rewardReputation = 10.0

		PARAMETER
		{
			name = Rendezvous
			type = Rendezvous

			vessel = KSO Relay Marker
			distance = 100
		}
	}

	BEHAVIOUR
	{
		name = DestroyVessel
		type = DestroyVessel
		onState = CONTRACT_COMPLETED
		vessel = KSO Relay Marker
	}
}



CONTRACT_TYPE
{
	sortKey = b
	name = ConstellationsKsoRelay2
	group = KerbinConstellations

	title = Place two more relays in kerbostationary orbit
	description = The relay above the KSC is great but it can't reach the other side of Kerbin. We need two more satellites to form an equilateral triangle, this should give us a 360 degrees coverage.

	maxCompletions = 1
	maxSimultaneous = 1

	synopsis = Form an equilateral triangle of relays in kerbostationary orbit

	completedMessage = The relays are in position.

	prestige = Significant

	targetBody = Kerbin

	rewardScience = 0
	rewardReputation = 50
	rewardFunds = 150000.0
	advanceFunds = 200000.0
	failureReputation = 20
	failureFunds = 250000.0

	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract

		contractType = ConstellationsKsoRelay1
	}

	BEHAVIOUR
	{
		name = SpawnVessel
		type = SpawnVessel

		VESSEL
		{
			name = KSO Relay Marker A
			craftPart = constellations-dummy
			owned = False
			targetBody = Kerbin
			vesselType = DroppedPart

			ORBIT
			{
				SMA = 3463334.0398701429
				ECC = 0
				INC = 0
				LPE = 237.38459898406168
				LAN = 0
				MNA = 3.62668220424
				EPH = 18545.434569902998
				REF = 1
			}
		}
	}

	BEHAVIOUR
	{
		name = SpawnVessel
		type = SpawnVessel

		VESSEL
		{
			name = KSO Relay Marker B
			craftPart = constellations-dummy
			owned = False
			targetBody = Kerbin
			vesselType = DroppedPart

			ORBIT
			{
				SMA = 3463334.0398701429
				ECC = 0
				INC = 0
				LPE = 237.38459898406168
				LAN = 0
				MNA = 5.72107730424
				EPH = 18545.434569902998
				REF = 1
			}
		}
	}

	DATA
	{
		type = VesselIdentifier
		relayA = the first relay
	}

	PARAMETER
	{
		name = KSORelayA
		type = VesselParameterGroup

		define = @/relayA
		dissassociateVesselsOnContractFailure = true

		rewardFunds = 50000.0

		PARAMETER
		{
			name = NewVessel
			type = NewVessel
		}

		PARAMETER
		{
			name = HasCrew
			type = HasCrew
			minCrew = 0
			maxCrew = 0
		}

		PARAMETER
		{
			name = HasAntenna
			type = HasAntenna
			minAntennaPower = 200000000000 // 200G
			antennaType = RELAY
		}

		PARAMETER
		{
			name = SolarPower
			type = Any
			title = Have solar panels onboard

			PARAMETER
			{
				name = PartValidationStockSolar
				type = PartValidation
				title = 1 or more solar panels
				hideChildren = true

				partModule = ModuleDeployableSolarPanel
				minCount = 1
			}
		
			PARAMETER:NEEDS[NearFutureSolar]
			{
				name = PartValidationNearFutureSolar
				type = PartValidation
				title = 1 or more curved solar panels
				hideChildren = true
				
				partModule = ModuleCurvedSolarPanel
				minCount = 1
			}
		
			PARAMETER:NEEDS[Kopernicus]
			{
				name = PartValidationKopernicusSolar
				type = PartValidation
				hideChildren = true
				title = 1 or more solar panels
				partModule = KopernicusSolarPanel
				minCount = 1
			}
		}

		PARAMETER
		{
			name = Orbit
			type = Orbit

			targetBody = Kerbin

			minPeriod = 5h 58m 59s
			maxPeriod = 5h 59m 19s

			minAltitude = 2860834
			maxAltitude = 2865834

			maxInclination = 0.1
		}

		PARAMETER
		{
			name = Rendezvous
			type = Rendezvous

			vessel = KSO Relay Marker A
			distance = 10000

			title = Place the relay within 10km of the marker

			disableOnStateChange = true
		}

		duration = 2d
	}

	PARAMETER
	{
		name = VesselParameterGroup
		type = VesselParameterGroup

		vessel = @/relayA

		title = Circularize @/relayA's orbit at 2863334m with less than 100m deviation (Optional)

		optional = True
		rewardReputation = 8.0

		PARAMETER
		{
			name = Orbit
			type = Orbit

			minAltitude = 2863234
			maxAltitude = 2863434
		}
	}

	PARAMETER
	{
		name = VesselParameterGroup
		type = VesselParameterGroup

		vessel = @/relayA

		title = Circularize the @/relayA's orbit at 2863334m with less than 1m deviation (Optional)

		optional = True
		rewardReputation = 16.0

		PARAMETER
		{
			name = Orbit
			type = Orbit

			minAltitude = 2863333.5
			maxAltitude = 2863334.49
		}
	}

	PARAMETER
	{
		name = VesselParameterGroup
		type = VesselParameterGroup

		vessel = @/relayA

		title = Place @/relayA within 100m of the marker (Optional)

		optional = True
		rewardReputation = 8.0

		PARAMETER
		{
			name = Rendezvous
			type = Rendezvous

			vessel = KSO Relay Marker A
			distance = 100
		}
	}

	DATA
	{
		type = VesselIdentifier
		relayB = the second relay
	}

	PARAMETER
	{
		name = KSORelayB
		type = VesselParameterGroup

		define = @/relayB
		dissassociateVesselsOnContractFailure = true

		rewardFunds = 50000.0

		PARAMETER
		{
			name = NewVessel
			type = NewVessel
		}

		PARAMETER
		{
			name = HasCrew
			type = HasCrew
			minCrew = 0
			maxCrew = 0
		}

		PARAMETER
		{
			name = HasAntenna
			type = HasAntenna
			minAntennaPower = 200000000000 // 200G
			antennaType = RELAY
		}

		PARAMETER
		{
			name = SolarPower
			type = Any
			title = Have solar panels onboard

			PARAMETER
			{
				name = PartValidationStockSolar
				type = PartValidation
				title = 1 or more solar panels
				hideChildren = true

				partModule = ModuleDeployableSolarPanel
				minCount = 1
			}
		
			PARAMETER:NEEDS[NearFutureSolar]
			{
				name = PartValidationNearFutureSolar
				type = PartValidation
				title = 1 or more curved solar panels
				hideChildren = true
				
				partModule = ModuleCurvedSolarPanel
				minCount = 1
			}
		
			PARAMETER:NEEDS[Kopernicus]
			{
				name = PartValidationKopernicusSolar
				type = PartValidation
				hideChildren = true
				title = 1 or more solar panels
				partModule = KopernicusSolarPanel
				minCount = 1
			}
		}

		PARAMETER
		{
			name = Orbit
			type = Orbit

			targetBody = Kerbin

			minPeriod = 5h 58m 59s
			maxPeriod = 5h 59m 19s

			minAltitude = 2860834
			maxAltitude = 2865834

			maxInclination = 0.1
		}

		PARAMETER
		{
			name = Rendezvous
			type = Rendezvous

			vessel = KSO Relay Marker B
			distance = 10000

			title = Place the relay within 10km of the marker

			disableOnStateChange = true
		}

		duration = 2d
	}

	PARAMETER
	{
		name = VesselParameterGroup
		type = VesselParameterGroup

		vessel = @/relayB

		title = Circularize @/relayB's orbit at 2863334m with less than 100m deviation (Optional)

		optional = True
		rewardReputation = 8.0

		PARAMETER
		{
			name = Orbit
			type = Orbit

			minAltitude = 2863234
			maxAltitude = 2863434
		}
	}

	PARAMETER
	{
		name = VesselParameterGroup
		type = VesselParameterGroup

		vessel = @/relayB

		title = Circularize @/relayB's orbit at 2863334m with less than 1m deviation (Optional)

		optional = True
		rewardReputation = 16.0

		PARAMETER
		{
			name = Orbit
			type = Orbit

			minAltitude = 2863333.5
			maxAltitude = 2863334.49
		}
	}

	PARAMETER
	{
		name = VesselParameterGroup
		type = VesselParameterGroup

		vessel = @/relayB

		title = Place @/relayB within 100m of the marker (Optional)

		optional = True
		rewardReputation = 8.0

		PARAMETER
		{
			name = Rendezvous
			type = Rendezvous

			vessel = KSO Relay Marker B
			distance = 100
		}
	}

	BEHAVIOUR
	{
		name = DestroyVessel
		type = DestroyVessel
		onState = PARAMETER_COMPLETED
		parameter = KSORelayA
		vessel = KSO Relay Marker A
	}

	BEHAVIOUR
	{
		name = DestroyVessel
		type = DestroyVessel
		onState = PARAMETER_COMPLETED
		parameter = KSORelayB
		vessel = KSO Relay Marker B
	}
}